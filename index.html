<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SomeAI</title>
  <link rel="icon"href="design/brandbook/someai/assets/LOGO.png">
  <link rel="apple-touch-icon" href="design/brandbook/someai/assets/LOGO.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* === Reset === */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* === Base Layout === */
    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: #141414;
      color: #E8E0E0;
      min-height: 100vh;
      padding: 0 24px 48px;
    }

    /* === Spider Web Background (Layer 1) === */
    #web-bg {
      position: fixed;
      inset: 0;
      z-index: -1;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }
    #web-bg svg {
      width: 120vmax;
      height: 120vmax;
    }
    .web-strands {
      animation: neural-idle 12s ease-in-out infinite;
    }
    @keyframes neural-idle {
      0%, 100% { opacity: 0.04; }
      50% { opacity: 0.07; }
    }
    .junction { opacity: 0; transition: opacity 0.1s; }

    /* === Micro-Graph Background (full page, behind everything) === */
    #particle-canvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      pointer-events: none;
    }

    /* === Compact SomeAI Header === */
    .site-header {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px 4px 12px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .site-header img {
      width: 44px;
      height: 44px;
      object-fit: contain;
    }
    .site-header h1 {
      font-size: 26px;
      font-weight: 800;
      letter-spacing: -1px;
      background: linear-gradient(135deg, #FFFFFF 0%, #C4A8A8 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .site-header .tagline {
      font-size: 13px;
      color: #666666;
      margin-left: auto;
    }

    /* === Live Badge === */
    .live-badge {
      display: inline-block;
      font-size: 10px;
      padding: 3px 10px;
      border-radius: 20px;
      background: rgba(229,62,62,0.12);
      color: #E53E3E;
      font-weight: 600;
      letter-spacing: 0.3px;
      text-transform: uppercase;
      margin-left: 8px;
      animation: badge-pulse 2s ease-in-out infinite;
    }
    @keyframes badge-pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(229,62,62,0.2); }
      50% { box-shadow: 0 0 12px 2px rgba(229,62,62,0.15); }
    }

    /* === Divider === */
    .divider {
      max-width: 1200px;
      margin: 0 auto 40px;
      border: none;
      border-top: 1px solid #333333;
    }

    /* === Section Labels === */
    .section-group {
      max-width: 1200px;
      margin: 0 auto 48px;
    }
    .section-label {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 0 4px;
    }
    .section-label h2 {
      font-size: 16px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }
    .section-label .count {
      font-size: 11px;
      color: #666666;
      font-weight: 500;
    }
    .section-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #333333;
    }
    .section-label.kernel h2 { color: #E53E3E; }
    .section-label.domain h2 { color: #68D391; }
    .section-label.reference h2 { color: #C4A8A8; }
    .section-label.research h2 { color: #F59E0B; }

    /* === Tags === */
    .tag {
      display: inline-block;
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 4px;
      background: rgba(229,62,62,0.12);
      color: #F56565;
      margin-top: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 500;
    }
    .tag-kernel { background: rgba(229,62,62,0.12); color: #F56565; }
    .tag-domain { background: rgba(104,211,145,0.12); color: #68D391; }
    .tag-reference { background: rgba(196,168,168,0.12); color: #C4A8A8; }
    .tag-research { background: rgba(245,158,11,0.12); color: #F59E0B; }

    /* === Cards + Grid === */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 16px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .card {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px 20px;
      background: #1A1A1A;
      border: 1px solid #333333;
      border-radius: 12px;
      text-decoration: none;
      color: #E8E0E0;
      position: relative;
      isolation: isolate;
      overflow: hidden;
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.6s ease, transform 0.6s ease, background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .card.visible {
      opacity: 1;
      transform: none;
    }
    .card:hover {
      background: #222222;
      border-color: #444444;
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }

    /* Hover Shimmer */
    .card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(105deg, transparent 40%, rgba(229,62,62,0.06) 50%, transparent 60%);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
      z-index: -1;
      pointer-events: none;
    }
    .card:hover::before {
      transform: translateX(100%);
    }

    .icon { font-size: 28px; flex-shrink: 0; }
    .card-text h2 { font-size: 15px; font-weight: 600; }
    .card-text p { font-size: 12px; color: #666666; margin-top: 2px; }

    /* Card category borders */
    .card-kernel { border-color: rgba(229,62,62,0.25); }
    .card-kernel:hover { border-color: #E53E3E; box-shadow: 0 8px 24px rgba(229,62,62,0.15); }
    .card-domain { border-color: rgba(104,211,145,0.25); }
    .card-domain:hover { border-color: #68D391; box-shadow: 0 8px 24px rgba(104,211,145,0.15); }

    /* Dual-link cards (operation + brand book) */
    .card-duo { cursor: pointer; }
    .card-main { color: inherit; text-decoration: none; }
    .card-main::after {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 1;
    }
    .card-brand {
      position: absolute;
      top: 8px;
      right: 8px;
      z-index: 2;
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 3px 8px;
      border-radius: 4px;
      background: rgba(104,211,145,0.1);
      color: #68D391;
      text-decoration: none;
      transition: background 0.2s, color 0.2s;
    }
    .card-brand:hover {
      background: rgba(104,211,145,0.25);
      color: #9AE6B4;
    }
    .card-research { border-color: rgba(245,158,11,0.25); }
    .card-research:hover { border-color: #F59E0B; box-shadow: 0 8px 24px rgba(245,158,11,0.15); }

    /* === Force Graph === */
    #force-graph {
      max-width: 1200px;
      margin: 0 auto 48px;
      text-align: center;
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    #force-graph.visible { opacity: 1; transform: none; }
    .fg-header { margin-bottom: 24px; }
    .fg-header h2 {
      font-size: 18px;
      font-weight: 700;
      color: #E53E3E;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 4px;
    }
    .fg-header p { font-size: 13px; color: #666666; }
    #fg-canvas {
      display: block;
      margin: 0 auto;
      cursor: grab;
      border-radius: 12px;
      background: #111;
      border: 1px solid #222;
    }
    #fg-canvas:active { cursor: grabbing; }
    #fg-tooltip {
      position: fixed;
      padding: 10px 16px;
      background: #1A1A1A;
      border: 1px solid #444;
      border-radius: 8px;
      color: #E8E0E0;
      font-size: 13px;
      font-weight: 500;
      font-family: 'Inter', sans-serif;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 100;
      white-space: nowrap;
    }
    #fg-tooltip.show { opacity: 1; }

    /* === Charlotte Charts Section === */
    .charts-section {
      max-width: 1200px;
      margin: 0 auto 48px;
    }
    .charts-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 0 4px;
    }
    .charts-header h2 {
      font-size: 16px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: #E53E3E;
    }
    .charts-header::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #333333;
    }
    .charts-theme-select {
      padding: 6px 12px;
      border-radius: 8px;
      border: 1px solid #333;
      background: #1A1A1A;
      color: #E8E0E0;
      font-family: 'Inter', sans-serif;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      outline: none;
      margin-left: auto;
      order: -1;
    }
    .charts-theme-select:focus { border-color: #E53E3E; }
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
    }
    .chart-card {
      background: #1A1A1A;
      border: 1px solid #333333;
      border-radius: 12px;
      overflow: hidden;
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.6s ease, transform 0.6s ease, border-color 0.2s;
    }
    .chart-card.visible { opacity: 1; transform: none; }
    .chart-card:hover { border-color: #444; }
    .chart-card-tag {
      font-size: 9px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #E53E3E;
      padding: 12px 16px 0;
      opacity: 0.7;
    }
    .chart-card-head {
      padding: 4px 16px 0;
    }
    .chart-card-head h3 {
      font-size: 14px;
      font-weight: 600;
      color: #E8E0E0;
      letter-spacing: -0.01em;
    }
    .chart-card-head p {
      font-size: 11px;
      color: #666;
      margin-top: 1px;
    }
    .chart-card-body {
      padding: 10px 16px 16px;
    }
    .chart-card-body canvas { display: block; max-width: 100%; }
    .chart-card.wide { grid-column: span 2; }

    /* === RE Identity Row === */
    .re-row {
      max-width: 1200px;
      margin: 0 auto 24px;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 20px;
      background: #1A1A1A;
      border: 1px solid #333333;
      border-radius: 12px;
      flex-wrap: wrap;
    }
    .re-row-label {
      font-size: 13px;
      font-weight: 600;
      color: #C4A8A8;
      margin-right: 8px;
      white-space: nowrap;
    }
    .re-brand-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 12px;
      border-radius: 8px;
      background: rgba(104,211,145,0.08);
      border: 1px solid rgba(104,211,145,0.15);
      color: #68D391;
      font-size: 12px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.2s, border-color 0.2s;
    }
    .re-brand-chip:hover {
      background: rgba(104,211,145,0.15);
      border-color: rgba(104,211,145,0.3);
    }
    .re-brand-chip img {
      width: 18px;
      height: 18px;
      object-fit: contain;
      border-radius: 3px;
    }

    /* === Pipeline Kanban === */
    .pipeline-section {
      max-width: 1200px;
      margin: 0 auto 48px;
    }
    .pipeline-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 0 4px;
    }
    .pipeline-header h2 {
      font-size: 16px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: #68D391;
    }
    .pipeline-header::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #333333;
    }
    .kanban {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      padding-bottom: 8px;
      scroll-snap-type: x proximity;
      -webkit-overflow-scrolling: touch;
    }
    .kanban::-webkit-scrollbar { height: 6px; }
    .kanban::-webkit-scrollbar-track { background: #1A1A1A; border-radius: 3px; }
    .kanban::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    .kanban-col {
      min-width: 220px;
      flex: 1 0 220px;
      scroll-snap-align: start;
    }
    .kanban-col-header {
      padding: 10px 14px;
      border-radius: 10px 10px 0 0;
      background: #1A1A1A;
      border: 1px solid #333;
      border-bottom: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .kanban-col-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    .kanban-col-header h3 {
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #E8E0E0;
    }
    .kanban-col-header .col-count {
      font-size: 10px;
      color: #666;
      margin-left: auto;
    }
    .kanban-col-body {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 10px;
      background: rgba(26,26,26,0.5);
      border: 1px solid #333;
      border-top: none;
      border-radius: 0 0 10px 10px;
      min-height: 60px;
    }
    .kanban-card {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: #1A1A1A;
      border: 1px solid #333;
      border-radius: 8px;
      text-decoration: none;
      color: #E8E0E0;
      transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;
    }
    .kanban-card:hover {
      background: #222;
      border-color: #444;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .kanban-card .kc-icon {
      font-size: 22px;
      flex-shrink: 0;
    }
    .kanban-card .kc-icon img {
      width: 22px;
      height: 22px;
      object-fit: contain;
      border-radius: 3px;
    }
    .kanban-card .kc-text h4 {
      font-size: 13px;
      font-weight: 600;
    }
    .kanban-card .kc-text p {
      font-size: 10px;
      color: #666;
      margin-top: 1px;
    }
    .kanban-card .kc-badges {
      margin-left: auto;
      display: flex;
      gap: 4px;
    }
    .kc-badge {
      font-size: 8px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      padding: 2px 6px;
      border-radius: 3px;
      text-decoration: none;
      transition: background 0.2s;
    }
    .kc-badge-brand {
      background: rgba(104,211,145,0.1);
      color: #68D391;
    }
    .kc-badge-brand:hover { background: rgba(104,211,145,0.25); }
    .kc-badge-domain {
      background: rgba(229,62,62,0.1);
      color: #F56565;
    }

    /* === Reduced Motion === */
    @media (prefers-reduced-motion: reduce) {
      #web-bg { display: none !important; }
      #particle-canvas { display: none !important; }
      .card, #force-graph, .chart-card {
        opacity: 1 !important;
        transform: none !important;
        transition-duration: 0s !important;
        transition-delay: 0s !important;
      }
      .card::before { display: none !important; }
      .web-strands { animation: none !important; }
      .junction, .npulse { display: none !important; }
      .live-badge { animation: none !important; }
    }

    /* === Mobile === */
    @media (max-width: 700px) {
      #particle-canvas { display: none; }
      .site-header .tagline { display: none; }
      .chart-card.wide { grid-column: span 1; }
      .charts-grid { grid-template-columns: 1fr; }
      .re-row { gap: 8px; padding: 12px 14px; }
    }
  </style>
</head>
<body>

<!-- ═══════════ LAYER 1: Neural Synapse Web Background ═══════════ -->
<div id="web-bg">
  <svg id="web-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240">
    <defs>
      <filter id="synapse-glow" x="-200%" y="-200%" width="500%" height="500%">
        <feGaussianBlur in="SourceGraphic" stdDeviation="4" result="blur"/>
        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="junction-fire" x="-200%" y="-200%" width="500%" height="500%">
        <feGaussianBlur in="SourceGraphic" stdDeviation="2" result="blur"/>
        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
    </defs>
    <g class="web-strands" transform="translate(120,120)" stroke="#E53E3E" stroke-width="1.5" fill="none" stroke-opacity="0.08" stroke-linecap="round" stroke-linejoin="round">
      <line x1="0" y1="0" x2="0" y2="-108"/>
      <line x1="0" y1="0" x2="65" y2="-87"/>
      <line x1="0" y1="0" x2="103" y2="-33"/>
      <line x1="0" y1="0" x2="95" y2="50"/>
      <line x1="0" y1="0" x2="40" y2="100"/>
      <line x1="0" y1="0" x2="-40" y2="100"/>
      <line x1="0" y1="0" x2="-95" y2="50"/>
      <line x1="0" y1="0" x2="-103" y2="-33"/>
      <line x1="0" y1="0" x2="-65" y2="-87"/>
      <path d="M 0,-108 Q 38,-105 65,-87 Q 92,-65 103,-33 Q 108,10 95,50 Q 78,82 40,100 Q 5,110 -40,100 Q -78,82 -95,50 Q -108,10 -103,-33 Q -92,-65 -65,-87 Q -38,-105 0,-108 Z"/>
      <path d="M 0,-70 Q 24,-68 42,-56 Q 60,-42 67,-21 Q 70,7 62,32 Q 51,53 26,65 Q 3,72 -26,65 Q -51,53 -62,32 Q -70,7 -67,-21 Q -60,-42 -42,-56 Q -24,-68 0,-70 Z"/>
      <path d="M 0,-38 Q 13,-37 23,-30 Q 33,-23 36,-11 Q 38,4 34,18 Q 28,29 14,35 Q 2,39 -14,35 Q -28,29 -34,18 Q -38,4 -36,-11 Q -33,-23 -23,-30 Q -13,-37 0,-38 Z"/>
    </g>
    <g id="neural-junctions" transform="translate(120,120)">
      <circle class="junction" cx="0" cy="-108" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="65" cy="-87" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="103" cy="-33" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="95" cy="50" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="40" cy="100" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-40" cy="100" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-95" cy="50" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-103" cy="-33" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-65" cy="-87" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="0" cy="-70" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="42" cy="-56" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="67" cy="-21" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="62" cy="32" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="26" cy="65" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-26" cy="65" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-62" cy="32" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-67" cy="-21" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-42" cy="-56" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="0" cy="-38" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="23" cy="-30" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="36" cy="-11" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="34" cy="18" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="14" cy="35" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-14" cy="35" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-34" cy="18" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-36" cy="-11" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
      <circle class="junction" cx="-23" cy="-30" r="1.5" fill="#E53E3E" filter="url(#junction-fire)"/>
    </g>
    <g id="neural-pulses" transform="translate(120,120)">
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
      <circle class="npulse" r="2.5" fill="#E53E3E" opacity="0" filter="url(#synapse-glow)"/>
    </g>
  </svg>
</div>

<!-- ═══════════ Passcode Gate ═══════════ -->
<div id="gate" style="
  position:fixed;inset:0;z-index:9999;
  background:#141414;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  font-family:'Inter',-apple-system,sans-serif;
  transition:opacity 0.5s;
">
  <div id="gate-logo" style="
    width:120px;height:120px;
    border-radius:24px;
    background:#1A1A1A;
    border:1px solid #333333;
    display:flex;align-items:center;justify-content:center;
    margin-bottom:32px;
    padding:20px;
  "><img src="design/brandbook/someai/assets/LOGO.png" alt="SomeAI" style="width:72px;height:72px;object-fit:contain;filter:brightness(0) saturate(100%) invert(27%) sepia(89%) saturate(1800%) hue-rotate(343deg) brightness(93%);"></div>
  <p style="color:#666666;font-size:13px;letter-spacing:2px;text-transform:uppercase;margin-bottom:24px;">Enter Access Code</p>
  <input id="gate-input" type="password" autocomplete="off" autofocus
    placeholder="&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;"
    style="
      background:#1A1A1A;
      border:1px solid #333333;
      border-radius:12px;
      padding:14px 24px;
      font-size:18px;
      color:#E8E0E0;
      text-align:center;
      letter-spacing:4px;
      width:240px;
      outline:none;
      font-family:inherit;
      transition:border-color 0.2s;
    "
  >
  <p id="gate-error" style="color:#E53E3E;font-size:12px;margin-top:12px;opacity:0;transition:opacity 0.3s;">&nbsp;</p>
</div>

<script>
(function() {
  var PASSCODE = 'charles';
  var gate = document.getElementById('gate');
  var input = document.getElementById('gate-input');
  var error = document.getElementById('gate-error');

  if (sessionStorage.getItem('charles_auth') === '1') {
    gate.style.display = 'none';
  }

  input.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      if (input.value.toLowerCase().trim() === PASSCODE) {
        sessionStorage.setItem('charles_auth', '1');
        gate.style.opacity = '0';
        setTimeout(function() { gate.style.display = 'none'; }, 500);
      } else {
        input.value = '';
        input.style.borderColor = '#E53E3E';
        error.textContent = 'Invalid code';
        error.style.opacity = '1';
        setTimeout(function() {
          input.style.borderColor = '#333333';
          error.style.opacity = '0';
        }, 1500);
      }
    }
  });

  input.addEventListener('focus', function() { input.style.borderColor = '#444444'; });
  input.addEventListener('blur', function() { input.style.borderColor = '#333333'; });
})();
</script>

<!-- ═══════════ LAYER 2: Micro-Graph Background (full page) ═══════════ -->
<canvas id="particle-canvas"></canvas>

<!-- ═══════════ Compact SomeAI Header ═══════════ -->
<header class="site-header">
  <img src="design/brandbook/someai/assets/LOGO.png" alt="SomeAI">
  <h1>SomeAI</h1>
  <span class="tagline">Infrastructure for observable reality</span>
</header>

<!-- ═══════════ FORCE GRAPH: Project Constellation ═══════════ -->
<section id="force-graph">
  <div class="fg-header">
    <h2>Project Constellation</h2>
    <p>SomeAI at center &mdash; drag to explore, click any node to navigate</p>
  </div>
  <canvas id="fg-canvas"></canvas>
</section>
<div id="fg-tooltip"></div>

<hr class="divider">

<!-- ═══════════ RE IDENTITY ROW ═══════════ -->
<nav class="re-row">
  <span class="re-row-label">Richard Enterprises</span>
  <a class="re-brand-chip" href="design/brandbook/someai/">
    <img src="design/brandbook/someai/assets/LOGO.png" alt="">SomeAI
  </a>
  <a class="re-brand-chip" href="design/brandbook/isg/">
    <img src="design/brandbook/isg/assets/logo_and_name.png" alt="">ISG
  </a>
  <a class="re-brand-chip" href="design/brandbook/sounder/">
    <img src="design/brandbook/sounder/assets/SOUNDER_BRAND_ICON.png" alt="">Sounder
  </a>
  <a class="re-brand-chip" href="design/brandbook/serengeti/">Serengeti</a>
  <a class="re-brand-chip" href="design/brandbook/sea-lion/">Sea Lion</a>
</nav>

<!-- ═══════════ PIPELINE ═══════════ -->
<div class="pipeline-section">
  <div class="pipeline-header">
    <h2>Pipeline</h2>
  </div>
  <div class="kanban">
    <!-- ACTIVE -->
    <div class="kanban-col">
      <div class="kanban-col-header">
        <span class="kanban-col-dot" style="background:#68D391"></span>
        <h3>Active</h3>
        <span class="col-count">2</span>
      </div>
      <div class="kanban-col-body">
        <a class="kanban-card" href="business/industrial-service-group/">
          <span class="kc-icon"><img src="design/brandbook/isg/assets/logo_and_name.png" alt=""></span>
          <div class="kc-text">
            <h4>ISG</h4>
            <p>16 brands, $450M rev, equipment intelligence</p>
          </div>
          <div class="kc-badges">
            <span class="kc-badge kc-badge-domain">Mechanical</span>
          </div>
        </a>
        <a class="kanban-card" href="business/sounder/">
          <span class="kc-icon"><img src="design/brandbook/sounder/assets/SOUNDER_BRAND_ICON.png" alt=""></span>
          <div class="kc-text">
            <h4>Sounder</h4>
            <p>Unified swine genetics, 401K facts</p>
          </div>
          <div class="kc-badges">
            <span class="kc-badge kc-badge-domain">Biological</span>
          </div>
        </a>
      </div>
    </div>
    <!-- PARTNERSHIPS -->
    <div class="kanban-col">
      <div class="kanban-col-header">
        <span class="kanban-col-dot" style="background:#F59E0B"></span>
        <h3>Partnerships</h3>
        <span class="col-count">3</span>
      </div>
      <div class="kanban-col-body">
        <a class="kanban-card" href="business/sounder/nsr/">
          <span class="kc-icon">&#x1F4DC;</span>
          <div class="kc-text">
            <h4>NSR</h4>
            <p>National Swine Registry</p>
          </div>
        </a>
        <a class="kanban-card" href="business/sounder/cps/">
          <span class="kc-icon">&#x1F4DC;</span>
          <div class="kc-text">
            <h4>CPS</h4>
            <p>Certified Pedigree Swine</p>
          </div>
        </a>
        <a class="kanban-card" href="business/sounder/tsa/">
          <span class="kc-icon">&#x1F4DC;</span>
          <div class="kc-text">
            <h4>TSA</h4>
            <p>Tamworth Swine Association</p>
          </div>
        </a>
      </div>
    </div>
    <!-- PROPOSAL -->
    <div class="kanban-col">
      <div class="kanban-col-header">
        <span class="kanban-col-dot" style="background:#60A5FA"></span>
        <h3>Proposal</h3>
        <span class="col-count">9</span>
      </div>
      <div class="kanban-col-body">
        <a class="kanban-card" href="business/gesdate/">
          <span class="kc-icon">&#x1F437;</span>
          <div class="kc-text">
            <h4>GesDate</h4>
            <p>Herd management intelligence</p>
          </div>
          <div class="kc-badges">
            <span class="kc-badge kc-badge-domain">Biological</span>
          </div>
        </a>
        <a class="kanban-card" href="business/lineleap/">
          <span class="kc-icon">&#x1F378;</span>
          <div class="kc-text">
            <h4>LineLeap</h4>
            <p>Bar management intelligence</p>
          </div>
          <div class="kc-badges">
            <span class="kc-badge kc-badge-domain">Human</span>
          </div>
        </a>
        <a class="kanban-card" href="business/allstate-manufacturing/">
          <span class="kc-icon">&#x2692;</span>
          <div class="kc-text">
            <h4>All State Mfg</h4>
            <p>Metal fixtures, micro market</p>
          </div>
        </a>
        <a class="kanban-card" href="business/top-tier-moving/">
          <span class="kc-icon">&#x1F69A;</span>
          <div class="kc-text">
            <h4>Top Tier Moving</h4>
            <p>$14.4M billed, 98 crew</p>
          </div>
        </a>
        <a class="kanban-card" href="business/cardvault/">
          <span class="kc-icon">&#x1F3C6;</span>
          <div class="kc-text">
            <h4>CardVault</h4>
            <p>12 locations, collector intelligence</p>
          </div>
        </a>
        <a class="kanban-card" href="business/wendt-group/">
          <span class="kc-icon">&#x1F3AA;</span>
          <div class="kc-text">
            <h4>Wendt Group</h4>
            <p>ShowPig.com, 12K+ auctions</p>
          </div>
        </a>
        <a class="kanban-card" href="business/violins/">
          <span class="kc-icon">&#x1F3BB;</span>
          <div class="kc-text">
            <h4>PPP Instruments</h4>
            <p>$5.3M rare string portfolio</p>
          </div>
        </a>
        <a class="kanban-card" href="business/monroe-livestock/">
          <span class="kc-icon">&#x1F404;</span>
          <div class="kc-text">
            <h4>Monroe Livestock</h4>
            <p>Weekly auction, Adams County</p>
          </div>
        </a>
        <a class="kanban-card" href="business/sc-online-sales/">
          <span class="kc-icon">&#x1F3A4;</span>
          <div class="kc-text">
            <h4>SC Online Sales</h4>
            <p>5-species, 40K+ auctions</p>
          </div>
        </a>
      </div>
    </div>
    <!-- RESEARCH -->
    <div class="kanban-col">
      <div class="kanban-col-header">
        <span class="kanban-col-dot" style="background:#666"></span>
        <h3>Research</h3>
        <span class="col-count">0</span>
      </div>
      <div class="kanban-col-body" style="min-height:80px;">
      </div>
    </div>
  </div>
</div>

<hr class="divider">

<!-- ═══════════ KERNEL & INFRASTRUCTURE ═══════════ -->
<div class="section-group">
  <div class="section-label kernel"><h2>Kernel &amp; Infrastructure</h2><span class="count">9 modules</span></div>
  <div class="grid">
    <a class="card card-kernel" href="research-lab/">
      <span class="icon">&#x1F9E0;</span>
      <div class="card-text"><h2>Research Lab</h2><p>The entire project as a knowledge graph</p><span class="tag tag-kernel">Meta</span></div>
    </a>
    <a class="card card-kernel" href="knowledge-graph/">
      <span class="icon">&#x1F4DA;</span>
      <div class="card-text"><h2>Knowledge Graph</h2><p>Consolidated research library &mdash; every resource, document &amp; project</p><span class="tag tag-kernel">Library</span></div>
    </a>
    <a class="card card-kernel" href="charlotte-os/">
      <span class="icon">&#x2699;</span>
      <div class="card-text"><h2>Charlotte OS</h2><p>Boot image &mdash; 31 KRF fact stacks in first-order logic</p><span class="tag tag-kernel">Kernel</span></div>
    </a>
    <a class="card card-kernel" href="charlotte/temporal/">
      <span class="icon">&#x1F553;</span>
      <div class="card-text"><h2>Temporal Spine</h2><p>15 granularity lanes from Millennium to Hour &mdash; 22.6M nodes, 4 compass directions, 1,123 lines KRF</p><span class="tag tag-kernel">Substrate</span></div>
    </a>
    <a class="card card-kernel" href="charlotte/spatial/">
      <span class="icon">&#x1F5FA;</span>
      <div class="card-text"><h2>Spatial Substrate</h2><p>51 state nodes, 1,275 directional edges &mdash; convex hulls, centroids, 4,604 lines KRF</p><span class="tag tag-kernel">Substrate</span></div>
    </a>
    <a class="card card-kernel" href="tools/pitch-engine/">
      <span class="icon">&#x1F4CA;</span>
      <div class="card-text"><h2>Pitch Engine</h2><p>Presentation substrate &mdash; 21 widgets, 5 narrative arcs, deck generation</p><span class="tag tag-kernel">Studio</span></div>
    </a>
    <a class="card card-kernel" href="tools/pitch-engine/decks/index.html">
      <span class="icon">&#x1F4BD;</span>
      <div class="card-text"><h2>Pitch Decks</h2><p>8 businesses &times; 3 narratives &mdash; before/after Charlotte, gradient AI-centric slides</p><span class="tag tag-kernel">Studio</span></div>
    </a>
    <a class="card card-kernel" href="charlotte/charts/showcase/">
      <span class="icon">&#x1F4C9;</span>
      <div class="card-text"><h2>Charlotte Charts</h2><p>Chart library v3.3 &mdash; 34 types, 6 brand themes, mobile-first, zero dependencies</p><span class="tag tag-kernel">Library</span></div>
    </a>
    <a class="card card-kernel" href="papers/">
      <span class="icon">&#x1F4C4;</span>
      <div class="card-text"><h2>Research Papers</h2><p>13 draft papers across 13 venues &mdash; Nature to NeurIPS</p><span class="tag tag-research">Research</span></div>
    </a>
  </div>
</div>

<hr class="divider">

<!-- ═══════════ CHARLOTTE CHARTS SHOWCASE ═══════════ -->
<div class="charts-section">
  <div class="charts-header">
    <h2>Charlotte Charts</h2>
    <select id="charts-theme" class="charts-theme-select">
      <option value="someai">SomeAI</option>
      <option value="platform">Platform</option>
      <option value="sounder">Sounder</option>
      <option value="isg">ISG</option>
      <option value="richard">Richard Ent.</option>
      <option value="allstate">All State</option>
    </select>
  </div>
  <div class="charts-grid" id="charts-grid"></div>
</div>

<!-- ═══════════ Charlotte Charts Library ═══════════ -->
<script src="charlotte/charts/us-states.js"></script>
<script src="charlotte/charts/charlotte-charts.js"></script>

<!-- ═══════════ Master Animation Script ═══════════ -->
<script>
(function() {
  var REDUCED_MOTION = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  var IS_MOBILE = window.innerWidth < 700;
  var animating = true;

  document.addEventListener('visibilitychange', function() {
    animating = !document.hidden;
  });

  if (REDUCED_MOTION) {
    var allEls = document.querySelectorAll('.card, .chart-card, #force-graph');
    for (var i = 0; i < allEls.length; i++) allEls[i].classList.add('visible');
    return;
  }

  // === LAYER 5: Scroll-Triggered Card Entrances ===
  var scrollElements = document.querySelectorAll('.card, .chart-card, #force-graph');

  var parents = new Map();
  for (var i = 0; i < scrollElements.length; i++) {
    var el = scrollElements[i];
    var p = el.parentElement;
    if (!parents.has(p)) parents.set(p, []);
    parents.get(p).push(el);
  }
  parents.forEach(function(els) {
    for (var i = 0; i < els.length; i++) {
      els[i].style.transitionDelay = (i * 50) + 'ms';
    }
  });

  var scrollObserver = new IntersectionObserver(function(entries) {
    for (var i = 0; i < entries.length; i++) {
      if (entries[i].isIntersecting) {
        entries[i].target.classList.add('visible');
        scrollObserver.unobserve(entries[i].target);
      }
    }
  }, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });

  for (var i = 0; i < scrollElements.length; i++) {
    scrollObserver.observe(scrollElements[i]);
  }

  // === LAYER 1: Neural Synapse Web Animation ===
  var junctions = [
    [0,-108],[65,-87],[103,-33],[95,50],[40,100],[-40,100],[-95,50],[-103,-33],[-65,-87],
    [0,-70],[42,-56],[67,-21],[62,32],[26,65],[-26,65],[-62,32],[-67,-21],[-42,-56],
    [0,-38],[23,-30],[36,-11],[34,18],[14,35],[-14,35],[-34,18],[-36,-11],[-23,-30]
  ];

  var adjList = [];
  for (var i = 0; i < 27; i++) adjList.push([]);
  for (var i = 0; i < 9; i++) {
    adjList[i].push(i + 9); adjList[i + 9].push(i);
    adjList[i + 9].push(i + 18); adjList[i + 18].push(i + 9);
  }
  for (var ring = 0; ring < 3; ring++) {
    var base = ring * 9;
    for (var i = 0; i < 9; i++) {
      var next = base + (i + 1) % 9;
      adjList[base + i].push(next);
      adjList[next].push(base + i);
    }
  }

  var junctionEls = document.querySelectorAll('#neural-junctions .junction');
  var pulseEls = document.querySelectorAll('#neural-pulses .npulse');
  var MAX_SIGNALS = IS_MOBILE ? 3 : 6;
  var signals = [];
  var junctionFlashes = [];
  var nextFireTime = 1000 + Math.random() * 2000;
  var fireAccum = 0;

  function fireNewSignal() {
    if (signals.length >= MAX_SIGNALS) return;
    var startIdx = Math.floor(Math.random() * 27);
    signals.push({
      from: startIdx,
      to: adjList[startIdx][Math.floor(Math.random() * adjList[startIdx].length)],
      t: 0,
      speed: 0.002 + Math.random() * 0.002,
      intensity: 0.8 + Math.random() * 0.2,
      hops: 0,
      maxHops: 4 + Math.floor(Math.random() * 3),
      pulseIdx: -1
    });
  }

  function updateNeuralWeb(dt) {
    fireAccum += dt;
    if (fireAccum >= nextFireTime) {
      fireAccum = 0;
      nextFireTime = 2000 + Math.random() * 3000;
      fireNewSignal();
    }

    var usedPulses = new Set();
    for (var i = 0; i < signals.length; i++) {
      if (signals[i].pulseIdx >= 0) usedPulses.add(signals[i].pulseIdx);
    }
    for (var i = 0; i < signals.length; i++) {
      if (signals[i].pulseIdx < 0) {
        for (var p = 0; p < pulseEls.length; p++) {
          if (!usedPulses.has(p)) {
            signals[i].pulseIdx = p;
            usedPulses.add(p);
            break;
          }
        }
      }
    }

    for (var i = signals.length - 1; i >= 0; i--) {
      var s = signals[i];
      s.t += s.speed * dt;

      if (s.t >= 1) {
        junctionFlashes.push({ idx: s.to, opacity: 0.8, decay: 0.001 });
        s.hops++;
        s.intensity *= 0.75;

        if (s.hops >= s.maxHops || s.intensity < 0.15) {
          if (s.pulseIdx >= 0) pulseEls[s.pulseIdx].setAttribute('opacity', '0');
          signals.splice(i, 1);
          continue;
        }

        if (Math.random() < 0.2 && signals.length < MAX_SIGNALS) {
          var branchNeighbors = adjList[s.to].filter(function(n) { return n !== s.from; });
          if (branchNeighbors.length > 0) {
            signals.push({
              from: s.to,
              to: branchNeighbors[Math.floor(Math.random() * branchNeighbors.length)],
              t: 0, speed: s.speed, intensity: s.intensity * 0.7,
              hops: s.hops, maxHops: s.maxHops, pulseIdx: -1
            });
          }
        }

        var neighbors = adjList[s.to].filter(function(n) { return n !== s.from; });
        if (neighbors.length === 0) {
          if (s.pulseIdx >= 0) pulseEls[s.pulseIdx].setAttribute('opacity', '0');
          signals.splice(i, 1);
          continue;
        }
        s.from = s.to;
        s.to = neighbors[Math.floor(Math.random() * neighbors.length)];
        s.t = 0;
      }

      if (s.pulseIdx >= 0 && s.pulseIdx < pulseEls.length) {
        var fromJ = junctions[s.from];
        var toJ = junctions[s.to];
        var cx = fromJ[0] + (toJ[0] - fromJ[0]) * s.t;
        var cy = fromJ[1] + (toJ[1] - fromJ[1]) * s.t;
        var el = pulseEls[s.pulseIdx];
        el.setAttribute('cx', cx.toFixed(1));
        el.setAttribute('cy', cy.toFixed(1));
        el.setAttribute('opacity', (s.intensity * 0.9).toFixed(2));
      }
    }

    for (var i = junctionFlashes.length - 1; i >= 0; i--) {
      var f = junctionFlashes[i];
      f.opacity -= f.decay * dt;
      if (f.opacity <= 0) {
        if (junctionEls[f.idx]) junctionEls[f.idx].setAttribute('opacity', '0');
        junctionFlashes.splice(i, 1);
      } else {
        if (junctionEls[f.idx]) junctionEls[f.idx].setAttribute('opacity', f.opacity.toFixed(2));
      }
    }
  }

  // === LAYER 2: Micro-Graph Particle Network ===
  var canvas = document.getElementById('particle-canvas');
  var microGraphs = [];
  var allNodes = [];
  var ctx, W, H;
  var pTime = 0;

  var NODE_COLORS = [
    '#FED7D7','#FEB2B2','#FC8181','#F56565','#E53E3E','#C53030','#9B2C2C','#822727',
  ];

  if (canvas && !IS_MOBILE) {
    ctx = canvas.getContext('2d');

    function resizeCanvas() {
      W = window.innerWidth;
      H = window.innerHeight;
      var dpr = window.devicePixelRatio || 1;
      canvas.width = W * dpr;
      canvas.height = H * dpr;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    var GRAPH_COUNT = 256;
    for (var g = 0; g < GRAPH_COUNT; g++) {
      var cx = Math.random() * (W || 800);
      var cy = Math.random() * (H || 400);
      var nodeCount = 3 + Math.floor(Math.random() * 4);
      var spread = 18 + Math.random() * 14;
      var baseColor = NODE_COLORS[Math.floor(Math.random() * NODE_COLORS.length)];
      var graph = {
        cx: cx, cy: cy,
        vx: (Math.random() - 0.5) * 0.3,
        vy: (Math.random() - 0.5) * 0.3,
        rot: Math.random() * 6.2832,
        rotSpeed: (Math.random() - 0.5) * 0.003,
        nodes: [], edges: [],
        baseColor: baseColor,
        pulse: Math.random() * 6.2832
      };

      for (var n = 0; n < nodeCount; n++) {
        var angle = (n / nodeCount) * 6.2832 + (Math.random() - 0.5) * 0.8;
        var dist = spread * (0.4 + Math.random() * 0.6);
        var useColor = Math.random() < 0.3
          ? NODE_COLORS[Math.floor(Math.random() * NODE_COLORS.length)]
          : baseColor;
        var node = {
          ox: Math.cos(angle) * dist,
          oy: Math.sin(angle) * dist,
          r: 1.5 + Math.random() * 2.5,
          color: useColor,
          graphIdx: g,
          wx: 0, wy: 0
        };
        graph.nodes.push(node);
        allNodes.push(node);
      }

      var hubIdx = Math.floor(Math.random() * nodeCount);
      for (var n = 0; n < nodeCount; n++) {
        if (n !== hubIdx) graph.edges.push([hubIdx, n]);
      }
      var extras = 1 + Math.floor(Math.random() * 2);
      for (var e = 0; e < extras; e++) {
        var a = Math.floor(Math.random() * nodeCount);
        var b = Math.floor(Math.random() * nodeCount);
        if (a !== b) graph.edges.push([a, b]);
      }

      microGraphs.push(graph);
    }
  }

  function drawParticles() {
    if (!ctx || !W || !H) return;
    ctx.globalAlpha = 1;
    ctx.fillStyle = '#141414';
    ctx.fillRect(0, 0, W, H);
    pTime += 0.016;

    for (var g = 0; g < microGraphs.length; g++) {
      var mg = microGraphs[g];
      mg.cx += mg.vx; mg.cy += mg.vy;
      mg.vx *= 0.9995; mg.vy *= 0.9995;
      mg.rot += mg.rotSpeed;

      if (mg.cx < -60) mg.cx = W + 60;
      if (mg.cx > W + 60) mg.cx = -60;
      if (mg.cy < -60) mg.cy = H + 60;
      if (mg.cy > H + 60) mg.cy = -60;

      var pulse = 1 + Math.sin(pTime * 1.2 + mg.pulse) * 0.08;
      var cosR = Math.cos(mg.rot);
      var sinR = Math.sin(mg.rot);
      for (var n = 0; n < mg.nodes.length; n++) {
        var nd = mg.nodes[n];
        nd.wx = mg.cx + (nd.ox * cosR - nd.oy * sinR) * pulse;
        nd.wy = mg.cy + (nd.ox * sinR + nd.oy * cosR) * pulse;
      }
    }

    var LINK_DIST = 140;
    var LINK_DIST2 = LINK_DIST * LINK_DIST;
    ctx.lineWidth = 0.4;
    for (var g = 0; g < microGraphs.length; g++) {
      for (var g2 = g + 1; g2 < microGraphs.length; g2++) {
        var dx = microGraphs[g].cx - microGraphs[g2].cx;
        var dy = microGraphs[g].cy - microGraphs[g2].cy;
        var d2 = dx * dx + dy * dy;
        if (d2 > LINK_DIST2 || d2 < 1) continue;

        var d = Math.sqrt(d2);
        var fade = 1 - d / LINK_DIST;

        var na = microGraphs[g].nodes[0];
        var nb = microGraphs[g2].nodes[0];

        ctx.beginPath();
        ctx.moveTo(na.wx, na.wy);
        ctx.lineTo(nb.wx, nb.wy);
        ctx.strokeStyle = '#E53E3E';
        ctx.globalAlpha = fade * 0.12;
        ctx.stroke();

        var speed = 0.3 + (g % 5) * 0.08;
        var phase = (g * 7 + g2 * 13) % 100 / 100;
        var t = ((pTime * speed + phase) % 1);
        var sx = na.wx + (nb.wx - na.wx) * t;
        var sy = na.wy + (nb.wy - na.wy) * t;

        ctx.beginPath();
        ctx.arc(sx, sy, 1.5, 0, 6.2832);
        ctx.fillStyle = '#F56565';
        ctx.globalAlpha = fade * 0.6;
        ctx.fill();
      }
    }

    for (var g = 0; g < microGraphs.length; g++) {
      var mg = microGraphs[g];

      ctx.strokeStyle = mg.baseColor;
      ctx.lineWidth = 0.6;
      for (var e = 0; e < mg.edges.length; e++) {
        var edge = mg.edges[e];
        var na = mg.nodes[edge[0]];
        var nb = mg.nodes[edge[1]];
        ctx.beginPath();
        ctx.moveTo(na.wx, na.wy);
        ctx.lineTo(nb.wx, nb.wy);
        ctx.globalAlpha = 0.18 + Math.sin(pTime * 2 + mg.pulse + e) * 0.06;
        ctx.stroke();
      }

      for (var n = 0; n < mg.nodes.length; n++) {
        var nd = mg.nodes[n];
        ctx.fillStyle = nd.color;
        ctx.beginPath();
        ctx.arc(nd.wx, nd.wy, nd.r * 2.2, 0, 6.2832);
        ctx.globalAlpha = 0.04;
        ctx.fill();
        ctx.beginPath();
        ctx.arc(nd.wx, nd.wy, nd.r, 0, 6.2832);
        ctx.globalAlpha = 0.55;
        ctx.fill();
      }
    }
    ctx.globalAlpha = 1;
  }

  // === MAIN ANIMATION LOOP ===
  var lastTime = 0;

  function loop(time) {
    if (!animating) {
      lastTime = 0;
      requestAnimationFrame(loop);
      return;
    }

    var dt = lastTime ? Math.min(time - lastTime, 50) : 16;
    lastTime = time;

    updateNeuralWeb(dt);
    if (canvas && !IS_MOBILE) drawParticles();

    requestAnimationFrame(loop);
  }

  requestAnimationFrame(loop);

  // === FORCE GRAPH: Project Constellation ===
  var fgCanvas = document.getElementById('fg-canvas');
  if (fgCanvas) { (function() {
    var fctx = fgCanvas.getContext('2d');
    var B = '';

    var CC = {
      anchor:     { s: '#E53E3E', t: '#E53E3E' },
      parent:     { s: '#F59E0B', t: '#F59E0B' },
      engine:     { s: '#E53E3E', t: '#F56565' },
      kernel:     { s: '#E53E3E', t: '#F56565' },
      domain:     { s: '#68D391', t: '#68D391' },
      research:   { s: '#F59E0B', t: '#F59E0B' },
      instrument: { s: '#444',   t: '#999' }
    };

    var N = [
      // === Anchors ===
      {id:'someai',n:'SomeAI',i:'\u2B21',u:B+'design/brandbook/someai/',c:'anchor',r:22,p:null},
      {id:'re',n:'Richard Enterprises',i:'\u{1F981}',u:B+'design/brandbook/richard-enterprises/',c:'parent',r:14,p:'someai'},
      {id:'charlotte',n:'Charlotte',i:'\u{1F578}',u:null,c:'engine',r:18,p:'someai'},
      // === Clients (-> SomeAI) ===
      {id:'sounder',n:'Sounder',i:'\u{1F417}',u:B+'business/sounder/',c:'domain',r:9,p:'someai'},
      {id:'isg',n:'ISG',i:'\u{1F3ED}',u:B+'business/industrial-service-group/',c:'domain',r:9,p:'someai'},
      {id:'ppp',n:'PPP Instruments',i:'\u{1F3BB}',u:B+'business/violins/',c:'domain',r:8,p:'someai'},
      {id:'toptier',n:'Top Tier',i:'\u{1F69A}',u:B+'business/top-tier-moving/',c:'domain',r:8,p:'someai'},
      {id:'allstate',n:'All State Mfg',i:'\u2692',u:B+'business/allstate-manufacturing/',c:'domain',r:8,p:'someai'},
      {id:'cardvault',n:'CardVault',i:'\u{1F3C6}',u:B+'business/cardvault/',c:'domain',r:7,p:'someai'},
      {id:'wendt',n:'Wendt Group',i:'\u{1F3AA}',u:B+'business/wendt-group/',c:'domain',r:7,p:'someai'},
      {id:'monroe',n:'Monroe Livestock',i:'\u{1F404}',u:B+'business/monroe-livestock/',c:'domain',r:7,p:'someai'},
      {id:'sconline',n:'SC Online Sales',i:'\u{1F3A4}',u:B+'business/sc-online-sales/',c:'domain',r:7,p:'someai'},
      {id:'lineleap',n:'LineLeap',i:'\u{1F378}',u:B+'business/lineleap/',c:'domain',r:7,p:'someai'},
      {id:'gesdate',n:'GesDate',i:'\u{1F437}',u:B+'business/gesdate/',c:'domain',r:7,p:'someai'},
      {id:'sealion',n:'Sea Lion',i:'\u{1F9AD}',u:B+'references/sealion/',c:'domain',r:7,p:'someai'},
      // === Kernel (-> Charlotte) ===
      {id:'researchlab',n:'Research Lab',i:'\u{1F9E0}',u:B+'research-lab/',c:'kernel',r:9,p:'charlotte'},
      {id:'kg',n:'Knowledge Graph',i:'\u{1F4DA}',u:B+'knowledge-graph/',c:'kernel',r:8,p:'charlotte'},
      {id:'cos',n:'Charlotte OS',i:'\u2699',u:B+'charlotte-os/',c:'kernel',r:9,p:'charlotte'},
      {id:'temporal',n:'Temporal Spine',i:'\u{1F553}',u:B+'charlotte/temporal/',c:'kernel',r:8,p:'charlotte'},
      {id:'spatial',n:'Spatial',i:'\u{1F5FA}',u:B+'charlotte/spatial/',c:'kernel',r:8,p:'charlotte'},
      {id:'papers',n:'Papers',i:'\u{1F4C4}',u:B+'papers/',c:'kernel',r:7,p:'charlotte'},
      {id:'pitcheng',n:'Pitch Engine',i:'\u{1F4CA}',u:B+'tools/pitch-engine/',c:'kernel',r:8,p:'charlotte'},
      {id:'pitchdecks',n:'Pitch Decks',i:'\u{1F4BD}',u:B+'tools/pitch-engine/decks/index.html',c:'kernel',r:6,p:'pitcheng'},
      {id:'charts',n:'Charts',i:'\u{1F4C9}',u:B+'charlotte/charts/showcase/',c:'kernel',r:7,p:'charlotte'},
      {id:'pipeline',n:'Pipeline',i:'\u{1F4C8}',u:B+'business/forecast.html',c:'kernel',r:7,p:'charlotte'},
      {id:'bizkrf',n:'Biz Model KRF',i:'\u{1F4BE}',u:B+'charlotte/docs/artifacts/business_model.krf',c:'kernel',r:6,p:'charlotte'},
      // === Math / Research (-> Charlotte) ===
      {id:'cnn',n:'CNN',i:'\u{1F9E0}',u:B+'math/cnn/',c:'instrument',r:6,p:'charlotte'},
      {id:'neuralplay',n:'Neural Play',i:'\u{1F52E}',u:B+'math/neuralplayground/',c:'instrument',r:6,p:'charlotte'},
      {id:'chaos',n:'Chaos Theory',i:'\u{1F300}',u:B+'math/chaostheory/',c:'instrument',r:6,p:'charlotte'},
      {id:'fourier',n:'Fourier',i:'\u3030',u:B+'math/fourier/',c:'instrument',r:6,p:'charlotte'},
      {id:'sacredgeo',n:'Sacred Geo',i:'\u2721',u:B+'math/sacred-geometry/',c:'instrument',r:6,p:'charlotte'},
      {id:'tsp',n:'TSP',i:'\u{1F5FA}',u:B+'math/tsp-algorithm-visualizer/',c:'instrument',r:6,p:'charlotte'},
      {id:'swarm',n:'Swarm Intel',i:'\u{1F41D}',u:B+'math/swarm-intelligence/',c:'research',r:7,p:'charlotte'},
      {id:'zeuscar',n:'Zeus Car',i:'\u{1F697}',u:B+'zeus-car-kit/',c:'research',r:6,p:'charlotte'},
    ];

    var edges = [];
    var idMap = {};
    for (var i = 0; i < N.length; i++) idMap[N[i].id] = i;
    for (var i = 0; i < N.length; i++) {
      if (N[i].p && idMap[N[i].p] !== undefined) {
        edges.push([idMap[N[i].p], i]);
      }
    }

    var adj = [];
    for (var i = 0; i < N.length; i++) adj[i] = [];
    for (var i = 0; i < edges.length; i++) {
      adj[edges[i][0]].push(edges[i][1]);
      adj[edges[i][1]].push(edges[i][0]);
    }

    var W, H;
    function sizeCanvas() {
      var containerW = fgCanvas.parentElement.offsetWidth;
      W = Math.min(containerW, 1200);
      H = IS_MOBILE ? 500 : 650;
      var dpr = window.devicePixelRatio || 1;
      fgCanvas.style.width = W + 'px';
      fgCanvas.style.height = H + 'px';
      fgCanvas.width = W * dpr;
      fgCanvas.height = H * dpr;
      fctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    sizeCanvas();

    var nodes = [];
    for (var i = 0; i < N.length; i++) {
      var nd = N[i];
      var angle = Math.random() * Math.PI * 2;
      var dist = 50 + Math.random() * 200;
      var yBias = 0;
      if (nd.id === 're') yBias = -180;
      else if (nd.id === 'charlotte') yBias = 140;
      else if (nd.c === 'kernel' || nd.c === 'engine' || nd.c === 'research') yBias = 60 + Math.random() * 100;
      else if (nd.c === 'domain') yBias = -40 + Math.random() * 60 - 30;
      else if (nd.c === 'parent') yBias = -160;
      else yBias = Math.random() * 80 - 40;

      nodes.push({
        x: W/2 + Math.cos(angle) * dist,
        y: H/2 + yBias + Math.sin(angle) * dist * 0.3,
        vx: 0, vy: 0,
        pinned: nd.id === 'someai'
      });
    }
    nodes[0].x = W/2;
    nodes[0].y = H/2;

    function simStep() {
      var REPULSION = 3000;
      var SPRING = 0.008;
      var REST_LEN = IS_MOBILE ? 50 : 75;
      var GRAVITY = 0.002;
      var DAMPING = 0.88;
      var Y_BIAS = 0.003;

      for (var i = 0; i < nodes.length; i++) {
        for (var j = i + 1; j < nodes.length; j++) {
          var dx = nodes[j].x - nodes[i].x;
          var dy = nodes[j].y - nodes[i].y;
          var d2 = dx*dx + dy*dy;
          if (d2 < 1) d2 = 1;
          var d = Math.sqrt(d2);
          var f = REPULSION / d2;
          var fx = (dx/d) * f;
          var fy = (dy/d) * f;
          if (!nodes[i].pinned) { nodes[i].vx -= fx; nodes[i].vy -= fy; }
          if (!nodes[j].pinned) { nodes[j].vx += fx; nodes[j].vy += fy; }
        }
      }

      for (var i = 0; i < edges.length; i++) {
        var a = nodes[edges[i][0]], b = nodes[edges[i][1]];
        var dx = b.x - a.x, dy = b.y - a.y;
        var d = Math.sqrt(dx*dx + dy*dy);
        if (d < 0.1) d = 0.1;
        var f = (d - REST_LEN) * SPRING;
        var fx = (dx/d) * f, fy = (dy/d) * f;
        if (!a.pinned) { a.vx += fx; a.vy += fy; }
        if (!b.pinned) { b.vx -= fx; b.vy -= fy; }
      }

      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].pinned) continue;
        nodes[i].vx += (W/2 - nodes[i].x) * GRAVITY;
        nodes[i].vy += (H/2 - nodes[i].y) * GRAVITY;

        var nd = N[i];
        if (nd.id === 're') nodes[i].vy += (H*0.15 - nodes[i].y) * Y_BIAS;
        else if (nd.id === 'charlotte') nodes[i].vy += (H*0.72 - nodes[i].y) * Y_BIAS;
        else if (nd.c === 'parent') nodes[i].vy += (H*0.12 - nodes[i].y) * Y_BIAS * 0.5;
        else if (nd.c === 'kernel' || nd.c === 'engine') nodes[i].vy += (H*0.7 - nodes[i].y) * Y_BIAS * 0.3;
        else if (nd.c === 'domain') nodes[i].vy += (H*0.35 - nodes[i].y) * Y_BIAS * 0.2;
      }

      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].pinned) { nodes[i].vx = 0; nodes[i].vy = 0; continue; }
        nodes[i].vx *= DAMPING;
        nodes[i].vy *= DAMPING;
        nodes[i].x += nodes[i].vx;
        nodes[i].y += nodes[i].vy;
        var pad = N[i].r + 4;
        if (nodes[i].x < pad) { nodes[i].x = pad; nodes[i].vx *= -0.5; }
        if (nodes[i].x > W - pad) { nodes[i].x = W - pad; nodes[i].vx *= -0.5; }
        if (nodes[i].y < pad) { nodes[i].y = pad; nodes[i].vy *= -0.5; }
        if (nodes[i].y > H - pad) { nodes[i].y = H - pad; nodes[i].vy *= -0.5; }
      }
    }

    for (var s = 0; s < 300; s++) simStep();

    var fgHovered = -1;
    var fgDragging = -1;

    function drawGraph() {
      fctx.clearRect(0, 0, W, H);

      for (var i = 0; i < edges.length; i++) {
        var a = nodes[edges[i][0]], b = nodes[edges[i][1]];
        var bCat = N[edges[i][1]].c;
        var highlighted = (fgHovered === edges[i][0] || fgHovered === edges[i][1]);
        fctx.beginPath();
        fctx.moveTo(a.x, a.y);
        fctx.lineTo(b.x, b.y);
        if (highlighted) {
          fctx.strokeStyle = CC[bCat] ? CC[bCat].s : '#444';
          fctx.globalAlpha = 0.6;
          fctx.lineWidth = 1.5;
        } else {
          fctx.strokeStyle = '#333';
          fctx.globalAlpha = 0.25;
          fctx.lineWidth = 0.8;
        }
        fctx.stroke();
        fctx.globalAlpha = 1;
      }

      for (var i = 0; i < N.length; i++) {
        var nd = N[i];
        var nx = nodes[i].x, ny = nodes[i].y;
        var col = CC[nd.c] || CC.instrument;
        var hov = (i === fgHovered);
        var connected = false;
        if (fgHovered >= 0 && fgHovered !== i) {
          for (var j = 0; j < adj[fgHovered].length; j++) {
            if (adj[fgHovered][j] === i) { connected = true; break; }
          }
        }
        var dimmed = (fgHovered >= 0 && !hov && !connected);

        var r = nd.r * (IS_MOBILE ? 0.8 : 1);
        if (hov) r *= 1.3;

        if ((nd.c === 'anchor' || nd.c === 'engine' || hov) && !dimmed) {
          fctx.save();
          fctx.shadowColor = col.s;
          fctx.shadowBlur = hov ? 18 : 10;
          fctx.beginPath();
          fctx.arc(nx, ny, r, 0, Math.PI * 2);
          fctx.fillStyle = 'rgba(0,0,0,0.01)';
          fctx.fill();
          fctx.restore();
        }

        fctx.beginPath();
        fctx.arc(nx, ny, r, 0, Math.PI * 2);
        fctx.globalAlpha = dimmed ? 0.15 : 1;
        fctx.fillStyle = hov ? col.s : (nd.c === 'anchor' ? 'rgba(229,62,62,0.3)' :
                         nd.c === 'engine' ? 'rgba(229,62,62,0.2)' :
                         nd.c === 'parent' ? 'rgba(245,158,11,0.2)' :
                         nd.c === 'kernel' ? 'rgba(229,62,62,0.12)' :
                         nd.c === 'domain' ? 'rgba(104,211,145,0.15)' :
                         nd.c === 'research' ? 'rgba(245,158,11,0.12)' :
                         'rgba(102,102,102,0.12)');
        fctx.fill();

        fctx.beginPath();
        fctx.arc(nx, ny, r, 0, Math.PI * 2);
        fctx.strokeStyle = col.s;
        fctx.lineWidth = hov ? 2 : 1;
        fctx.globalAlpha = dimmed ? 0.1 : (hov ? 1 : 0.6);
        fctx.stroke();
        fctx.globalAlpha = 1;

        if (r >= 5) {
          var emojiSize = Math.max(8, Math.round(r * 1.1));
          fctx.font = emojiSize + 'px serif';
          fctx.textAlign = 'center';
          fctx.textBaseline = 'middle';
          fctx.globalAlpha = dimmed ? 0.15 : 1;
          fctx.fillText(nd.i, nx, ny - 1);
          fctx.globalAlpha = 1;
        }

        if (r >= 7 || hov) {
          var nameSize = Math.max(7, Math.round(r * 0.7));
          if (nd.c === 'anchor') nameSize = 11;
          else if (nd.c === 'engine' || nd.c === 'parent') nameSize = 9;
          fctx.font = '600 ' + nameSize + 'px Inter, sans-serif';
          fctx.textAlign = 'center';
          fctx.textBaseline = 'top';
          fctx.fillStyle = hov ? '#FFFFFF' : col.t;
          fctx.globalAlpha = dimmed ? 0.1 : (hov ? 1 : 0.7);
          fctx.fillText(nd.n, nx, ny + r + 3);
          fctx.globalAlpha = 1;
        }
      }
    }

    function hitTest(mx, my) {
      for (var i = N.length - 1; i >= 0; i--) {
        var dx = mx - nodes[i].x, dy = my - nodes[i].y;
        var hitR = Math.max(N[i].r * 1.5, 10);
        if (dx*dx + dy*dy < hitR*hitR) return i;
      }
      return -1;
    }

    var fgMouseX = 0, fgMouseY = 0;
    function getPos(e) {
      var rect = fgCanvas.getBoundingClientRect();
      return { x: e.clientX - rect.left, y: e.clientY - rect.top };
    }

    fgCanvas.addEventListener('mousemove', function(e) {
      var p = getPos(e);
      fgMouseX = e.clientX; fgMouseY = e.clientY;
      if (fgDragging >= 0 && !nodes[fgDragging].pinned) {
        nodes[fgDragging].x = p.x;
        nodes[fgDragging].y = p.y;
        nodes[fgDragging].vx = 0;
        nodes[fgDragging].vy = 0;
      }
      var idx = hitTest(p.x, p.y);
      if (idx !== fgHovered) {
        fgHovered = idx;
        fgCanvas.style.cursor = idx >= 0 ? 'pointer' : 'grab';
      }
      var tip = document.getElementById('fg-tooltip');
      if (fgHovered >= 0) {
        tip.textContent = N[fgHovered].n;
        tip.classList.add('show');
      } else {
        tip.classList.remove('show');
      }
      tip.style.left = (e.clientX + 14) + 'px';
      tip.style.top = (e.clientY - 36) + 'px';
    });

    fgCanvas.addEventListener('mousedown', function(e) {
      var p = getPos(e);
      var idx = hitTest(p.x, p.y);
      if (idx >= 0) {
        fgDragging = idx;
        fgCanvas.style.cursor = 'grabbing';
      }
    });

    fgCanvas.addEventListener('mouseup', function(e) {
      if (fgDragging >= 0) {
        var p = getPos(e);
        var dx = p.x - nodes[fgDragging].x, dy = p.y - nodes[fgDragging].y;
        if (dx*dx + dy*dy < 4 && N[fgDragging].u) {
          window.open(N[fgDragging].u, '_self');
        }
        fgDragging = -1;
        fgCanvas.style.cursor = fgHovered >= 0 ? 'pointer' : 'grab';
      }
    });

    fgCanvas.addEventListener('mouseleave', function() {
      fgHovered = -1;
      fgDragging = -1;
      document.getElementById('fg-tooltip').classList.remove('show');
    });

    fgCanvas.addEventListener('touchstart', function(e) {
      var t = e.touches[0];
      var rect = fgCanvas.getBoundingClientRect();
      var p = { x: t.clientX - rect.left, y: t.clientY - rect.top };
      var idx = hitTest(p.x, p.y);
      if (idx >= 0) { fgDragging = idx; fgHovered = idx; e.preventDefault(); }
    }, { passive: false });

    fgCanvas.addEventListener('touchmove', function(e) {
      if (fgDragging >= 0) {
        var t = e.touches[0];
        var rect = fgCanvas.getBoundingClientRect();
        nodes[fgDragging].x = t.clientX - rect.left;
        nodes[fgDragging].y = t.clientY - rect.top;
        nodes[fgDragging].vx = 0;
        nodes[fgDragging].vy = 0;
        e.preventDefault();
      }
    }, { passive: false });

    fgCanvas.addEventListener('touchend', function(e) {
      if (fgDragging >= 0 && N[fgDragging].u) {
        window.open(N[fgDragging].u, '_self');
      }
      fgDragging = -1;
      fgHovered = -1;
    });

    var fgFrame;
    function fgLoop() {
      simStep();
      drawGraph();
      fgFrame = requestAnimationFrame(fgLoop);
    }

    var fgRunning = false;
    var fgObs = new IntersectionObserver(function(entries) {
      if (entries[0].isIntersecting && !fgRunning) {
        fgRunning = true;
        fgLoop();
      } else if (!entries[0].isIntersecting && fgRunning) {
        fgRunning = false;
        cancelAnimationFrame(fgFrame);
      }
    }, { threshold: 0.05 });
    fgObs.observe(fgCanvas);

    window.addEventListener('resize', function() {
      var oldW = W, oldH = H;
      sizeCanvas();
      var sx = W / oldW, sy = H / oldH;
      for (var i = 0; i < nodes.length; i++) {
        nodes[i].x *= sx;
        nodes[i].y *= sy;
      }
    });
  })(); }

})();
</script>

<!-- ═══════════ Charlotte Charts Showcase Renderer ═══════════ -->
<script>
(function() {
  var CCharts = window.CharlotteCharts;
  if (!CCharts) return;
  var U = CCharts.utils;

  // Synthetic data
  var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  var revenue = [45, 52, 48, 61, 58, 72, 68, 85, 79, 92, 88, 105];
  var costs = [32, 36, 35, 41, 39, 48, 46, 55, 52, 58, 56, 64];
  var profit = revenue.map(function(r,i){ return r - costs[i]; });

  var fwRadar = { axes: ['Speed','Memory','DX','Ecosystem','Perf','Bundle Size'], series: [
    { name: 'React', values: [72,65,88,95,78,60], color: '#61dafb' },
    { name: 'Vue', values: [80,72,92,75,82,75], color: '#42b883' },
    { name: 'Svelte', values: [95,90,85,55,94,92], color: '#ff3e00' },
    { name: 'Angular', values: [60,50,65,80,70,45], color: '#dd0031' },
  ]};

  var ohlc = [
    {label:'Mon',open:142,high:148,low:139,close:146},{label:'Tue',open:146,high:152,low:143,close:144},
    {label:'Wed',open:144,high:147,low:138,close:140},{label:'Thu',open:140,high:145,low:136,close:143},
    {label:'Fri',open:143,high:155,low:141,close:153},{label:'Mon',open:153,high:158,low:150,close:156},
    {label:'Tue',open:156,high:162,low:153,close:160},{label:'Wed',open:160,high:165,low:155,close:158},
    {label:'Thu',open:158,high:163,low:152,close:155},{label:'Fri',open:155,high:170,low:154,close:168},
    {label:'Mon',open:168,high:174,low:163,close:171},{label:'Tue',open:171,high:176,low:168,close:173},
    {label:'Wed',open:173,high:178,low:166,close:169},{label:'Thu',open:169,high:175,low:165,close:174},
    {label:'Fri',open:174,high:182,low:172,close:180},
  ];
  var closes = ohlc.map(function(c){return c.close;});
  var volume = ohlc.map(function(c){return Math.abs(c.close-c.open)*100+Math.floor(Math.random()*500+200);});
  var revCum = U.integral(revenue);

  // Activity heatmap data
  var activityCells = [];
  for (var w = 0; w < 52; w++) {
    for (var d = 0; d < 7; d++) {
      var seasonal = Math.sin((w / 52) * Math.PI * 2 - Math.PI/2) * 0.3 + 0.5;
      var dayBias = d < 5 ? 1 : 0.3;
      activityCells.push({ value: Math.random() < 0.15 ? 0 : Math.max(0, Math.round((Math.random() * 10 + 2) * seasonal * dayBias)) });
    }
  }

  // Network data
  var netData = {
    nodes: [
      {id:'a',label:'SomeAI',group:0},{id:'b',label:'Charlotte',group:0},
      {id:'c',label:'ISG',group:1},{id:'d',label:'Sounder',group:1},
      {id:'e',label:'Pitch Engine',group:2},{id:'f',label:'Charts',group:2},
      {id:'g',label:'Temporal',group:2},{id:'h',label:'Spatial',group:2},
    ],
    edges: [
      {source:'a',target:'b'},{source:'a',target:'c'},{source:'a',target:'d'},
      {source:'b',target:'e'},{source:'b',target:'f'},{source:'b',target:'g'},{source:'b',target:'h'},
      {source:'c',target:'e'},{source:'d',target:'f'},
    ]
  };

  var grid = document.getElementById('charts-grid');

  function makeCard(tag, title, sub, wide) {
    var el = document.createElement('div');
    el.className = 'chart-card' + (wide ? ' wide' : '');
    el.innerHTML = '<div class="chart-card-tag">' + tag + '</div>' +
      '<div class="chart-card-head"><h3>' + title + '</h3><p>' + sub + '</p></div>' +
      '<div class="chart-card-body"></div>';
    grid.appendChild(el);
    return el.querySelector('.chart-card-body');
  }

  function renderCharts(themeName) {
    CCharts.setTheme(themeName);
    grid.innerHTML = '';

    var T = themeName;
    var b;

    // 1. Line
    b = makeCard('line', 'Monthly Revenue & Cost', 'Raw time series');
    CCharts.line(b, { labels: months, series: [
      { name: 'Revenue', values: revenue },
      { name: 'Cost', values: costs },
      { name: 'Profit', values: profit, showArea: true }
    ] }, { theme: T, showArea: false });

    // 2. Bar (grouped)
    b = makeCard('bar', 'Revenue vs Cost', 'Grouped comparison by month');
    CCharts.bar(b, { labels: months, series: [
      { name: 'Revenue', values: revenue },
      { name: 'Cost', values: costs }
    ] }, { theme: T, variant: 'grouped' });

    // 3. Donut
    b = makeCard('donut', 'Cost Breakdown', 'Where the money goes');
    CCharts.donut(b, { segments: [
      { label: 'COGS', value: 35 }, { label: 'R&D', value: 18 },
      { label: 'Sales', value: 12 }, { label: 'G&A', value: 8 },
    ], centerText: '73%', centerSub: 'of revenue' }, { theme: T });

    // 4. Radar
    b = makeCard('radar', 'Multi-Axis Profile', '6 dimensions at a glance');
    CCharts.radar(b, fwRadar, { theme: T });

    // 5. Candlestick
    b = makeCard('candlestick', '15-Day OHLC', 'Green = bullish, red = bearish', true);
    CCharts.candlestick(b, { candles: ohlc }, { theme: T });

    // 6. Gauge
    b = makeCard('gauge', 'Annual Target', '$900k goal');
    CCharts.gauge(b, { value: revCum[11], max: 900, unit: 'k', label: 'of $900k target' }, { theme: T });

    // 7. Network
    b = makeCard('network', 'Project Graph', 'Entity relationships');
    CCharts.network(b, netData, { theme: T });

    // 8. Heatmap
    var colLabels = [];
    for (var w = 0; w < 52; w++) colLabels.push(w % 4 === 0 ? 'W' + (w+1) : '');
    b = makeCard('heatmap', 'Activity Heatmap', '52 weeks of contribution data', true);
    CCharts.heatmap(b, { cells: activityCells, rows: 7, cols: 52, colLabels: colLabels }, { theme: T, cellSize: 11, gap: 2 });

    // 9. Waterfall
    b = makeCard('waterfall', 'Revenue to Profit Bridge', 'P&L flow decomposition');
    CCharts.waterfall(b, { items: [
      { label: 'Revenue', value: revCum[11], total: true },
      { label: 'COGS', value: -Math.round(revCum[11]*0.35) },
      { label: 'R&D', value: -Math.round(revCum[11]*0.18) },
      { label: 'S&M', value: -Math.round(revCum[11]*0.12) },
      { label: 'G&A', value: -Math.round(revCum[11]*0.08) },
      { label: 'Net', value: Math.round(revCum[11]*0.27), total: true },
    ]}, { theme: T });

    // 10. Choropleth (US map)
    b = makeCard('choropleth', 'US Coverage Map', 'Client density by state', true);
    CCharts.choropleth(b, { states: {CA:95,TX:82,NY:78,FL:71,IL:65,PA:60,OH:55,GA:52,NC:48,MI:45,NJ:43,VA:40,WA:38,AZ:35,MA:33,TN:30,IN:28,MO:25,MD:23,WI:20,CO:18,MN:16,SC:14,AL:12,LA:10,KY:9,OR:8,OK:7,CT:6,UT:5,IA:4,NV:3,AR:2,MS:1,KS:1,NE:1,NM:1,ID:1,WV:1,HI:2,NH:1,ME:1,MT:1,RI:1,DE:1,SD:1,ND:1,AK:2,VT:1,WY:1,DC:5} }, { theme: T, height: 380 });

    // Re-observe for scroll animation
    var chartCards = grid.querySelectorAll('.chart-card');
    var chartObs = new IntersectionObserver(function(entries) {
      for (var i = 0; i < entries.length; i++) {
        if (entries[i].isIntersecting) {
          entries[i].target.classList.add('visible');
          chartObs.unobserve(entries[i].target);
        }
      }
    }, { threshold: 0.08 });
    for (var i = 0; i < chartCards.length; i++) {
      chartCards[i].style.transitionDelay = (i * 50) + 'ms';
      chartObs.observe(chartCards[i]);
    }
  }

  // Initial render with SomeAI theme
  renderCharts('someai');

  // Theme switcher
  var select = document.getElementById('charts-theme');
  if (select) {
    select.addEventListener('change', function() {
      renderCharts(select.value);
    });
  }
})();
</script>


</body>
</html>
